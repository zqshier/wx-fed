"use strict";require("../../../sub-vendors.js");/*! For license information please see medalDetails.js.LICENSE.txt */
(wx.webpackJsonp=wx.webpackJsonp||[]).push([["packageA/pages/medal/medalDetails/medalDetails"],{"./node_modules/@nutui/nutui-taro/dist/packages/progress/index.mjs":function(e,a,s){s.d(a,{Progress:function(){return t}});const t=s("./node_modules/@nutui/nutui-taro/dist/packages/_es/Progress.js").default},"./node_modules/@nutui/nutui-taro/dist/packages/progress/style.mjs":function(e,a,s){s("./node_modules/@nutui/nutui-taro/dist/styles/reset.css"),s("./node_modules/@nutui/nutui-taro/dist/packages/progress/index.scss")},"./node_modules/@nutui/nutui-taro/dist/packages/progress/index.scss":function(){},"./node_modules/@tarojs/taro-loader/lib/raw.js!./src/packageA/pages/medal/medalDetails/medalDetails.vue":function(e,a,s){var t=s("./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=template&id=19a79df1&ts=true"),l=s("./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=script&setup=true&lang=ts"),n=s("./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=style&index=1&id=19a79df1&lang=scss&module=true"),r=s("./node_modules/vue-loader/dist/exportHelper.js");const o={};o.$style=n.default;const d=(0,r.default)(l.default,[["render",t.render],["__cssModules",o],["__file","src/packageA/pages/medal/medalDetails/medalDetails.vue"]]);a.default=d},"./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/babel-loader/lib/index.js??clonedRuleSet-21.use[0]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=script&setup=true&lang=ts":function(e,a,s){var t=s("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),l=s("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),n=s("./node_modules/vue/index.js"),r=s("./node_modules/@tarojs/taro/index.js"),o=s.n(r),d=s("./src/api/medal.ts"),u=s("./src/components/CustomBar/CustomBar.vue"),i=s("./src/components/CustomBar/props.ts"),c=s("./src/components/Loading/Loading.vue"),m=s("./src/dto/banner.ts"),p=s("./src/stores/index.ts"),g=s("./src/utils/index.ts");a.default=(0,n.defineComponent)({__name:"medalDetails",setup:function setup(e,a){(0,a.expose)();var s=o().getCurrentInstance().preloadData||{},r=s.data.medalId||null,_=(0,n.ref)(s.data||{}),f=(0,n.ref)(!1),v=(0,n.ref)(!1),k=(0,n.computed)((function(){var e;return null===(e=_.value)||void 0===e?void 0:e.createdAt})),b=(0,n.computed)((function(){var e;return"".concat((100*Number(null===(e=_.value)||void 0===e?void 0:e.ratio)).toFixed(2),"%用户拥有该勋章")})),j=(0,n.computed)((function(){return _.value.progress&&100*Number((_.value.progress[0]/_.value.progress[1]).toFixed(2))||0})),y=function(){var e=(0,l.default)((0,t.default)().mark((function _callee(){return(0,t.default)().wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:if(k.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,d.medalsWear)(r);case 5:(0,p.useMedailStore)().selectedInfo=_.value,_.value.selected=!0,(0,g.Toast)("佩戴成功，可在勋章列表查看"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log("wearMedal error: ",e.t0),(0,g.Toast)("佩戴失败");case 14:case"end":return e.stop()}}),_callee,null,[[2,10]])})));return function wearMedal(){return e.apply(this,arguments)}}(),x=function(){var e=(0,l.default)((0,t.default)().mark((function _callee2(){var e;return(0,t.default)().wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,d.medalsDetail)(r);case 3:e=a.sent,a.next=10;break;case 6:a.prev=6,a.t0=a.catch(0),console.log("error: ",a.t0),(0,g.Toast)(a.t0.message);case 10:return a.prev=10,f.value=!0,a.finish(10);case 13:if(e){a.next=15;break}return a.abrupt("return");case 15:_.value=e;case 16:case"end":return a.stop()}}),_callee2,null,[[0,6,10,13]])})));return function getMedalsDetail(){return e.apply(this,arguments)}}(),D=function(){var e=(0,l.default)((0,t.default)().mark((function _callee3(){var e,a;return(0,t.default)().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:if(!(k.value||_.value.subscribed||v.value)){s.next=2;break}return s.abrupt("return");case 2:return v.value=!0,e="SvqV7EFUqRjjLJCeNb8V0R-673HWeJzfxi213W9a75o",s.prev=4,s.next=7,(0,g.subscribeMessage)([e]);case 7:if(a=s.sent,console.log("res: ",a),"reject"!==a[e]){s.next=11;break}throw new Error("订阅失败");case 11:if("accept"===a[e]){s.next=13;break}return s.abrupt("return");case 13:return s.next=15,(0,d.medalsSubscribe)(r,{tplId:e,page:"pages/landing/landing?page=packageA/pages/medal/medalList/medalList"});case 15:_.value.subscribed=!0,(0,g.Toast)("订阅成功"),s.next=23;break;case 19:s.prev=19,s.t0=s.catch(4),console.error("handleSubscribe error",s.t0),(0,g.Toast)("订阅失败");case 23:return s.prev=23,v.value=!1,s.finish(23);case 26:case"end":return s.stop()}}),_callee3,null,[[4,19,23,26]])})));return function handleSubscribe(){return e.apply(this,arguments)}}();(0,n.onMounted)((0,l.default)((0,t.default)().mark((function _callee4(){return(0,t.default)().wrap((function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:case"end":return e.stop()}}),_callee4)}))));var w={routerInfo:s,medalId:r,medalInfo:_,isLoaded:f,loadingSubscribe:v,hasOwnership:k,ratio:b,medalPercentage:j,goPage:function goPage(){var e=_.value.link;if(e){var a=(0,g.isUrl)(e)?m.LinkType.h5:m.LinkType.path;(0,g.handleLink)(a,e)}},wearMedal:y,getMedalsDetail:x,handleSubscribe:D,CustomBar:u.default,get LogoColorType(){return i.LogoColorType},Loading:c.default};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}})},"./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/babel-loader/lib/index.js??clonedRuleSet-21.use[0]!./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[3]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=template&id=19a79df1&ts=true":function(e,a,s){s.d(a,{render:function(){return render}});var t=s("./src/components/BackgroundImage/BackgroundImage.vue"),l=s("./node_modules/@nutui/nutui-taro/dist/packages/button/index.mjs"),n=(s("./node_modules/@nutui/nutui-taro/dist/packages/button/style.mjs"),s("./node_modules/@nutui/nutui-taro/dist/packages/progress/index.mjs")),r=(s("./node_modules/@nutui/nutui-taro/dist/packages/progress/style.mjs"),s("./node_modules/vue/index.js")),o=["src"],d={key:0};function render(e,a,s,u,i,c){var m=n.Progress,p=l.Button,g=t.default;return(0,r.openBlock)(),(0,r.createBlock)(g,null,{default:(0,r.withCtx)((function(){return[(0,r.createVNode)(u.CustomBar,{title:"","bg-color":"transparent","logo-color":u.LogoColorType.BLACK},null,8,["logo-color"]),u.medalInfo&&u.isLoaded?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:(0,r.normalizeClass)([e.$style.main,"medalDetails_main nut-flex-col nut-row-center nut-col-center f_s-12"])},[(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)([e.$style.main_title,"f_s-24 f_w-600"])},(0,r.toDisplayString)(u.medalInfo.name),3),(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)(e.$style.main_ratio)},(0,r.toDisplayString)(u.ratio),3),(0,r.createElementVNode)("image",{mode:"aspectFill",src:u.hasOwnership?u.medalInfo.image1:u.medalInfo.image2,"lazy-load":!0,class:(0,r.normalizeClass)(e.$style.main_image),onTap:u.handleSubscribe},null,42,o),u.hasOwnership?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:(0,r.normalizeClass)(e.$style.main_finish)},[(0,r.createElementVNode)("text",null,(0,r.toDisplayString)(u.medalInfo.greetings),1)],2)):(0,r.createCommentVNode)("v-if",!0),(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)(e.$style.main_description)},[(0,r.createElementVNode)("text",null,(0,r.toDisplayString)(u.medalInfo.description),1),u.medalInfo.progress&&0!==u.medalInfo.progress[1]?((0,r.openBlock)(),(0,r.createElementBlock)("text",d,"（"+(0,r.toDisplayString)(u.medalInfo.progress[0])+"/"+(0,r.toDisplayString)(u.medalInfo.progress[1])+"）",1)):(0,r.createCommentVNode)("v-if",!0)],2),u.medalInfo.progress&&0!==u.medalInfo.progress[1]?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1,class:(0,r.normalizeClass)(e.$style.main_progress)},[(0,r.createVNode)(m,{percentage:u.medalPercentage,"show-text":!1,"stroke-color":"#BE8E08",size:"small"},null,8,["percentage"])],2)):(0,r.createCommentVNode)("v-if",!0),u.hasOwnership?((0,r.openBlock)(),(0,r.createBlock)(p,{key:2,shape:"round",type:"primary",disabled:u.medalInfo.selected,class:(0,r.normalizeClass)([e.$style.main_btn]),onClick:u.wearMedal},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(u.medalInfo.selected?"已佩戴":"佩戴勋章"),1)]})),_:1},8,["disabled","class"])):((0,r.openBlock)(),(0,r.createBlock)(p,{key:3,shape:"round",type:"primary",plain:"",class:(0,r.normalizeClass)([e.$style.main_btn,[e.$style["main_btn-no"]]]),onClick:u.goPage},{default:(0,r.withCtx)((function(){return[(0,r.createTextVNode)((0,r.toDisplayString)(u.medalInfo.grantTips),1)]})),_:1},8,["class"]))],2)):(0,r.createCommentVNode)("v-if",!0),(0,r.createVNode)(u.Loading,{show:!u.isLoaded},null,8,["show"])]})),_:1})}},"./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/@tarojs/webpack5-runner/node_modules/css-loader/dist/cjs.js??clonedRuleSet-7.use[1]!./node_modules/vue-loader/dist/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-7.use[2]!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-7.use[4]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=style&index=1&id=19a79df1&lang=scss&module=true":function(e,a){a.default={main:"medalDetails__main___Ys8uX",main_title:"medalDetails__main_title___KjKST",main_ratio:"medalDetails__main_ratio___r4BU5",main_image:"medalDetails__main_image___JQyz1",main_finish:"medalDetails__main_finish___plOxH",main_description:"medalDetails__main_description___CBfdH",main_progress:"medalDetails__main_progress___vwKZm",main_btn:"medalDetails__main_btn___Cy2cJ","main_btn-no":"medalDetails__main_btn-no___Mdro8","slide-bottom":"medalDetails__slide-bottom___P9rQj"}},"./src/packageA/pages/medal/medalDetails/medalDetails.vue":function(e,a,s){var t=s("./node_modules/@tarojs/runtime/dist/runtime.esm.js"),l=s("./node_modules/@tarojs/taro-loader/lib/raw.js!./src/packageA/pages/medal/medalDetails/medalDetails.vue");Page((0,t.createPageConfig)(l.default,"packageA/pages/medal/medalDetails/medalDetails",{root:{cn:[]}},{}||{})),l.default},"./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=script&setup=true&lang=ts":function(e,a,s){s.d(a,{default:function(){return t.default}});var t=s("./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/babel-loader/lib/index.js??clonedRuleSet-21.use[0]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=script&setup=true&lang=ts")},"./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=template&id=19a79df1&ts=true":function(e,a,s){s.d(a,{render:function(){return t.render}});var t=s("./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/babel-loader/lib/index.js??clonedRuleSet-21.use[0]!./node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[3]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=template&id=19a79df1&ts=true")},"./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=style&index=1&id=19a79df1&lang=scss&module=true":function(e,a,s){s.d(a,{default:function(){return t.default}});var t=s("./node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-components!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/@tarojs/webpack5-runner/node_modules/css-loader/dist/cjs.js??clonedRuleSet-7.use[1]!./node_modules/vue-loader/dist/stylePostLoader.js!./node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-7.use[2]!./node_modules/resolve-url-loader/index.js!./node_modules/sass-loader/dist/cjs.js??clonedRuleSet-7.use[4]!./node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./src/packageA/pages/medal/medalDetails/medalDetails.vue?vue&type=style&index=1&id=19a79df1&lang=scss&module=true")}},function(e){e.O(0,["packageA/sub-vendors","taro","vendors","common"],(function(){return a="./src/packageA/pages/medal/medalDetails/medalDetails.vue",e(e.s=a);var a}));e.O()}]);